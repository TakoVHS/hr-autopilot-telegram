# –ê–Ω–∞–ª–∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏
–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- **hr_policy.json** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è JSON-—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
- **regression_cases.md** ‚Äî —Ç–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### 2. –í—ã–≤–æ–¥—ã

#### ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ:
1. **Regression test cases** ‚Üí —É–ª—É—á—à–µ–Ω [TESTING_CHECKLIST.md](./TESTING_CHECKLIST.md)
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ–∂–∏–¥–∞–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è
   - –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ tool calls –∏ —Å—Ç–∞—Ç—É—Å–æ–≤
   - –¢–µ—Å—Ç—ã –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ (–¥—É–±–ª–∏ updates)
   - –¢–µ—Å—Ç—ã –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ (tool errors, timeouts)

2. **JSON-—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è** ‚Üí —Å–æ–∑–¥–∞–Ω [hr_policy_spec.json](./hr_policy_spec.json)
   - –°–ø—Ä–∞–≤–æ—á–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç (–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±—ç–∫–µ–Ω–¥–æ–º)
   - –§–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–π, knockout rules, reason_codes
   - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –±—É–¥—É—â–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

#### ‚ö†Ô∏è –ù–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ (–ø—Ä–∏—á–∏–Ω—ã):

**JSON-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è runtime:**
- ‚ùå –ë—ç–∫–µ–Ω–¥ **–Ω–µ –ø–∞—Ä—Å–∏—Ç** JSON-–ø–æ–ª–∏—Ç–∏–∫–∏
- ‚ùå OpenAI Assistant —Ä–∞–±–æ—Ç–∞–µ—Ç —Å **Markdown-–ø—Ä–æ–º–ø—Ç–æ–º**
- ‚ùå –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `vacancy_key`

**Follow-ups:**
- ‚ùå –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- ‚ùå –¢—Ä–µ–±—É–µ—Ç—Å—è Render Cron Jobs –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å

**Routing keywords (vip_keywords, abuse_keywords):**
- ‚ùå –ë—ç–∫–µ–Ω–¥ –Ω–µ –¥–µ–ª–∞–µ—Ç keyword-matching
- ‚úÖ –ü—Ä–∞–≤–∏–ª–∞ —ç—Å–∫–∞–ª–∞—Ü–∏–∏ —É–∂–µ –≤ –ø—Ä–æ–º–ø—Ç–µ (—Ä–∞–∑–¥–µ–ª 7)

### 3. –ü–æ—á–µ–º—É –≤—ã–±—Ä–∞–Ω —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥

**Single Source of Truth:**
- –ê–∫—Ç—É–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: [hr_agent_system.md](./prompts/hr_agent_system.md)
- –ö–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ OpenAI Platform ‚Üí Assistants ‚Üí Instructions
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –±–µ–∑ –¥–µ–ø–ª–æ—è

**JSON –∫–∞–∫ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫:**
- –î–ª—è –±—É–¥—É—â–µ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- –î–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –ù–µ —Å–æ–∑–¥–∞—ë—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å Markdown-–ø—Ä–æ–º–ø—Ç–æ–º

**–£–ª—É—á—à–µ–Ω–Ω—ã–π testing:**
- –î–µ—Ç–∞–ª—å–Ω—ã–µ regression cases
- –°—Ç—Ä–æ–≥–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
- –ü–æ–∫—Ä—ã—Ç–∏–µ edge cases (–¥—É–±–ª–∏, –æ—à–∏–±–∫–∏, —Ç–∞–π–º–∞—É—Ç—ã)

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: —á—Ç–æ –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è

| –≠–ª–µ–º–µ–Ω—Ç | hr_agent_system.md (–ø—Ä–æ–º–ø—Ç) | hr_policy_spec.json (—Å–ø—Ä–∞–≤–∫–∞) | –°—Ç–∞—Ç—É—Å |
|---------|----------------------------|-------------------------------|--------|
| –í–∞–∫–∞–Ω—Å–∏–∏ (5 —à—Ç.) | ‚úÖ –†–∞–∑–¥–µ–ª 2 | ‚úÖ vacancies[] | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã |
| Reason codes | ‚úÖ –†–∞–∑–¥–µ–ª 4 | ‚úÖ reason_codes{} | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã |
| Knockout-–∫—Ä–∏—Ç–µ—Ä–∏–∏ | ‚úÖ –†–∞–∑–¥–µ–ª 6 | ‚úÖ knockout_rules[] | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã |
| –ì–æ—Ä–æ–¥–∞ –Ω–∞–π–º–∞ | ‚úÖ –†–∞–∑–¥–µ–ª 2 | ‚úÖ locations.hire_cities | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã |
| –≠—Ç–∞–ª–æ–Ω–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏ | ‚úÖ –†–∞–∑–¥–µ–ª 12 | ‚ùå –ù–µ—Ç | –¢–æ–ª—å–∫–æ –≤ MD |
| Routing keywords | ‚úÖ –†–∞–∑–¥–µ–ª 7 (—Ç–µ–∫—Å—Ç–æ–º) | ‚úÖ routing.vip_keywords | JSON –¥–µ—Ç–∞–ª—å–Ω–µ–µ |
| Follow-ups | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | ‚úÖ followups.plans | –ë—É–¥—É—â–µ–µ |

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –°–µ–π—á–∞—Å:
1. **–û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫:** [hr_agent_system.md](./prompts/hr_agent_system.md)
   - –ö–æ–ø–∏—Ä—É–π –≤ OpenAI Platform ‚Üí Instructions
   - –û–±–Ω–æ–≤–ª—è–π –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤–∞–∫–∞–Ω—Å–∏–π/–∫—Ä–∏—Ç–µ—Ä–∏–µ–≤

2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** [TESTING_CHECKLIST.md](./TESTING_CHECKLIST.md)
   - –ü—Ä–æ–≥–æ–Ω—è–π regression pack –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–æ–º–ø—Ç–∞
   - –ü—Ä–æ–≤–µ—Ä—è–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è–º

3. **–°–ø—Ä–∞–≤–∫–∞:** [hr_policy_spec.json](./hr_policy_spec.json)
   - –î–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
   - –î–ª—è –±—É–¥—É—â–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

### –ë—É–¥—É—â–µ–µ:

**–ö–æ–≥–¥–∞ JSON —Å—Ç–∞–Ω–µ—Ç –∞–∫—Ç—É–∞–ª–µ–Ω:**
1. –ë—ç–∫–µ–Ω–¥ –±—É–¥–µ—Ç –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å `vacancy_key` –∏ `reason_code`
2. –ü–æ—è–≤–∏—Ç—Å—è UI –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª–∏—Ç–∏–∫
3. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å —Ñ–∏–∫—Å—Ç—É—Ä–∞–º–∏ –∏–∑ JSON
4. Follow-ups —á–µ—Ä–µ–∑ Render Cron Jobs

**–ö–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å:**
```python
# backend/app/core/policy.py
import json
from pathlib import Path

POLICY_FILE = Path(__file__).parent.parent.parent / "docs/hr_policy_spec.json"

def load_policy():
    with open(POLICY_FILE) as f:
        return json.load(f)

def validate_vacancy_key(key: str) -> bool:
    policy = load_policy()
    valid_keys = {v["vacancy_key"] for v in policy["vacancies"]}
    return key in valid_keys
```

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ø—Ä–æ–µ–∫—Ç:
1. ‚úÖ [TESTING_CHECKLIST.md](./TESTING_CHECKLIST.md) ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ã–µ regression cases
2. ‚úÖ [hr_policy_spec.json](./hr_policy_spec.json) ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∞—è JSON-—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
3. ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –≤–∞–∫–∞–Ω—Å–∏–π –∏ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤

### –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–ø–æ–∫–∞):
- ‚ùå –ü–∞—Ä—Å–∏–Ω–≥ JSON –≤ –±—ç–∫–µ–Ω–¥–µ
- ‚ùå Follow-up –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- ‚ùå Keyword-matching –¥–ª—è routing

### –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –§–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –±—É–¥—É—â–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –±–æ—Ç–∞** –ø–æ –Ω–æ–≤–æ–º—É regression pack
2. **–û–±–Ω–æ–≤–∏ –ø—Ä–æ–º–ø—Ç** –≤ OpenAI Platform (–µ—Å–ª–∏ –µ—â—ë –Ω–µ —Å–¥–µ–ª–∞–ª)
3. **–ü—Ä–æ–≥–æ–Ω–∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏** –∏–∑ TESTING_CHECKLIST.md
4. **–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤–∞–∫–∞–Ω—Å–∏–π:** –æ–±–Ω–æ–≤–ª—è–π –û–ë–ê —Ñ–∞–π–ª–∞ (MD + JSON)

**–í–æ–ø—Ä–æ—Å—ã?** –°–º. [SUMMARY.md](./SUMMARY.md) –¥–ª—è –ø–æ–ª–Ω–æ–π –∫–∞—Ä—Ç–∏–Ω—ã –ø—Ä–æ–µ–∫—Ç–∞.
