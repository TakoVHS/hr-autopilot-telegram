name: Followup Jobs

on:
  schedule:
    - cron: "*/30 * * * *"
  workflow_dispatch:

jobs:
  run-followup:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger followup job
        env:
          BACKEND_PUBLIC_URL: ${{ secrets.BACKEND_PUBLIC_URL }}
          INTERNAL_API_TOKEN: ${{ secrets.INTERNAL_API_TOKEN }}
        run: |
          if [ -z "$BACKEND_PUBLIC_URL" ] || [ -z "$INTERNAL_API_TOKEN" ]; then
            echo "Skipping: BACKEND_PUBLIC_URL or INTERNAL_API_TOKEN not set"
            exit 0
          fi
          curl -fsS -X POST "$BACKEND_PUBLIC_URL/jobs/followup" \
            -H "x-internal-token: $INTERNAL_API_TOKEN" || exit 1
